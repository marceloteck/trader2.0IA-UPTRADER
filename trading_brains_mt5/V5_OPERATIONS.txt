"""
V5_OPERATIONS.txt - Quick Operations Guide

Fast reference for deploying and running V5 system.
"""

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                        V5 OPERATIONS QUICK GUIDE
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

INITIAL SETUP (First Time)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

1. Clone repository
   git clone <repo> && cd trading_brains_mt5

2. Run installer
   INSTALL.bat
   [Creates venv, installs deps, init DB]
   [Takes 2-3 minutes]

3. Run setup wizard
   SETUP_WIZARD.bat
   [Interactive: asks for symbol, risk, limits]
   [Generates .env automatically]
   [Tests MT5 connection]

4. Validate installation
   RUN_HEALTHCHECK.bat
   [Should show: âœ… Database OK, âœ… MT5 Connected, âœ… Symbol available]

5. Run test suite
   RUN_TESTS.bat
   [Should show: passed N tests]

Result: System ready for paper trading

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

PAPER TRADING (Mandatory 8+ hours)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

Purpose: Validate system works correctly before using real money

1. Start paper trading
   RUN_LIVE_SIM.bat
   [Runs indefinitely, auto-restarts on crash]

2. Monitor first hour
   - Check logs: data/logs/app.log
   - Look for: Order placements, fills
   - Should see entries every few minutes

3. Leave running 8+ hours
   - System will place trades based on market conditions
   - Verify: SL/TP levels correct in MT5
   - Check: Daily report after first day (RUN_MAINTENANCE.bat â†’ option 5)

4. Validate results
   - Win rate should be > 40%
   - No errors in logs (search for "ERROR")
   - Divergence count: 0 (position reconciliation OK)
   - P&L makes sense (proportional to trades)

5. When ready
   - Proceed to live trading setup (next section)
   - Or adjust risk parameters and retry

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

LIVE TRADING ACTIVATION (3 Steps)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

âš ï¸  CRITICAL: Only after 8+ hours successful paper trading

Step 1: Create Confirmation File
   Windows CMD:
   mkdir data
   echo. > data\LIVE_OK.txt
   
   Windows PowerShell:
   New-Item -Path data -Name LIVE_OK.txt -ItemType File

Step 2: Update Configuration
   Edit .env file:
   
   Change:  LIVE_MODE=SIM
   To:      LIVE_MODE=REAL
   
   Verify:
   - RISK_PER_TRADE (e.g., 1.0)
   - DAILY_LOSS_LIMIT (e.g., 2.0)
   - MAX_TRADES_PER_DAY (e.g., 10)

Step 3: Start System
   RUN_PRODUCTION.bat
   
   [Will check for LIVE_OK.txt]
   [Will validate MT5 connection]
   [Will start trading in REAL mode]

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

DAILY OPERATIONS
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

MORNING (Market Open)
â”‚
â”œâ”€ 08:00 - Start system
â”‚  â””â”€ RUN_PRODUCTION.bat
â”‚
â”œâ”€ 08:05 - Quick validation
â”‚  â””â”€ RUN_HEALTHCHECK.bat
â”‚  [Should show: âœ… all systems]
â”‚
â””â”€ 08:10 - Monitor first trades
   [Watch data/logs/app.log for 5 minutes]
   [Should see order placements]

MIDDAY (Active Trading)
â”‚
â””â”€ Every 2 hours - Status check
   [Optional: RUN_HEALTHCHECK.bat]
   [Check: No stuck orders in MT5]
   [Check: Margin < 30%]

EVENING (Pre-Close)
â”‚
â”œâ”€ 17:00 - Review day
â”‚  [Check: Open positions reasonable]
â”‚  [Check: No large losses]
â”‚
â””â”€ 22:00 - End-of-day maintenance
   RUN_MAINTENANCE.bat
   [Select: 5 (daily-report)]
   [Review: data/exports/reports/YYYY-MM-DD_summary.txt]
   [Note: Win rate, P&L, errors]

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

MAINTENANCE SCHEDULE
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

DAILY
â”€â”€â”€â”€â”€
Time:   22:00 (after market close)
Task:   RUN_MAINTENANCE.bat
        Option 5: daily-report
        Generates: data/exports/reports/YYYY-MM-DD_summary.txt

WEEKLY (Sunday)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Time:   20:00
Tasks:  1. RUN_MAINTENANCE.bat
           Option 1: integrity-check
           Option 2: backup-db
           Option 3: VACUUM
        2. RUN_MAINTENANCE.bat
           Option 6: weekly-report
        3. Review: data/exports/reports/YYYY-W*_weekly_report.json

MONTHLY (Last day of month)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Tasks:  1. Review all weekly reports
        2. Archive old logs: RUN_MAINTENANCE.bat â†’ option 4
        3. Check backup count: 4+ should exist
        4. Update risk parameters if needed

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

EMERGENCY PROCEDURES
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

SYSTEM NOT RESPONDING (Watchdog Timeout)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Symptom:  No new orders for 30+ seconds
Solution:
1. System auto-restarts (handled)
2. If manual restart needed:
   taskkill /F /IM python.exe
   RUN_PRODUCTION.bat

ORDER STUCK IN MT5
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Symptom:  Order showing in MT5 but system thinks closed
Solution:
1. Create pause file:
   echo. > data\PAUSE.txt

2. Manually close order in MT5 terminal

3. Check position tracker:
   [system will auto-reconcile on next loop]

4. Delete pause file:
   del data\PAUSE.txt

DATABASE CORRUPTED
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Symptom:  "database disk image malformed" in logs
Solution:
1. Stop trading:
   echo. > data\STOP.txt

2. Run integrity check:
   RUN_MAINTENANCE.bat
   Option 1: integrity-check

3. If FAILED, restore from backup:
   - Find latest: data/db/backups/trading_*.db
   - Copy to: data/db/trading.db
   - Overwrite: Yes

4. Restart:
   del data\STOP.txt
   RUN_PRODUCTION.bat

MT5 DISCONNECTED
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Symptom:  "MT5 not connected" in logs
Solution:
1. Check MT5 terminal manually
   - Is MT5 running?
   - Is account logged in?
   - Can you see current price?

2. Restart MT5 terminal

3. Wait 60 seconds (auto-reconnect)

4. If still fails:
   RUN_HEALTHCHECK.bat
   [Will show error details]

MARGIN CALL
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Symptom:  Orders rejected with "insufficient funds"
Solution:
1. System triggers PAUSE automatically (safe)

2. Check account balance in MT5

3. Options:
   a) Deposit funds (if live account)
   b) Reduce RISK_PER_TRADE in .env (to 0.5%)
   c) Wait for profitable trades to recover
   d) Pause trading and review

4. Resume:
   [System auto-resumes when margin OK]

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

USEFUL COMMANDS
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

System Info
â””â”€ python -m src.main healthcheck

Database Operations
â”œâ”€ python -m src.main init-db              (initialize)
â”œâ”€ python -m src.main integrity-check      (verify)
â”œâ”€ python -m src.main backup-db            (manual backup)
â””â”€ python -m src.main maintenance          (backup + VACUUM + logs)

Reports
â”œâ”€ python -m src.main daily-report         (today's stats)
â”œâ”€ python -m src.main weekly-report        (7-day stats)
â”œâ”€ python -m src.main export-audit         (JSON trail)
â””â”€ RUN_MAINTENANCE.bat                     (interactive menu)

Logs
â”œâ”€ tail -f data/logs/app.log               (live monitoring)
â”œâ”€ grep ERROR data/logs/app.log            (find errors)
â””â”€ RUN_MAINTENANCE.bat â†’ option 4          (log rotation)

Manual Controls
â”œâ”€ echo. > data\PAUSE.txt                  (pause trading)
â”œâ”€ del data\PAUSE.txt                      (resume trading)
â”œâ”€ echo. > data\STOP.txt                   (hard stop + exit)
â””â”€ del data\LIVE_OK.txt                    (disable real mode)

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

TROUBLESHOOTING TREE
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

Is system running?
â”‚
â”œâ”€ NO â†’ Check error in logs: data/logs/app.log
â”‚       â””â”€ If "ERROR": Restart RUN_PRODUCTION.bat
â”‚
â”œâ”€ YES but no trades
â”‚       â”œâ”€ Market hours? (Check MT5 terminal)
â”‚       â”œâ”€ Symbol in watchlist? (Add to MT5)
â”‚       â””â”€ Brains disabled? (Check .env)
â”‚
â”œâ”€ YES but losing money
â”‚       â”œâ”€ Reduce RISK_PER_TRADE
â”‚       â”œâ”€ Review brains (brain scores in audit trail)
â”‚       â””â”€ Check regime (is market trending or ranging?)
â”‚
â””â”€ YES but slow/frozen
        â”œâ”€ Check database size: ls -lh data/db/trading.db
        â”œâ”€ If > 1GB: Run VACUUM (RUN_MAINTENANCE.bat â†’ option 3)
        â””â”€ Check logs for errors

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

DOCUMENTATION REFERENCES
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

Topic                          File
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Troubleshooting                docs/RUNBOOK.md
Pre-live & operational         docs/PRODUCTION_CHECKLIST.md
System architecture            README.md
Configuration                 .env.example
Error codes + recovery         docs/RUNBOOK.md (table)
Setup & quick start            This file + SETUP_WIZARD.bat
Component details              V4_IMPLEMENTATION_COMPLETE.txt
Version info                   V5_FINAL_SUMMARY.txt

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

CONTACT & SUPPORT
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

For issues, check in order:
1. docs/RUNBOOK.md (error code lookup + solutions)
2. data/logs/app.log (last 20 lines)
3. data/exports/reports/ (daily summary for context)
4. V4_QUICK_START.md (configuration help)

If still stuck:
- Export audit trail: python -m src.main export-audit
- Review decision context in exported JSON
- Check margin/balance in MT5
- Verify timeframes match configuration

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

QUICK REFERENCE CARD
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ DAILY CHECKLIST                                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â˜ 08:00  RUN_PRODUCTION.bat                         â”‚
â”‚ â˜ 08:05  RUN_HEALTHCHECK.bat                        â”‚
â”‚ â˜ 12:00  Check logs (no errors)                     â”‚
â”‚ â˜ 16:00  Verify no stuck orders                     â”‚
â”‚ â˜ 22:00  RUN_MAINTENANCE.bat â†’ daily-report         â”‚
â”‚ â˜ 22:30  Review report (P&L, win rate, errors)      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ WEEKLY CHECKLIST                                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â˜ Mon  RUN_MAINTENANCE.bat â†’ integrity-check        â”‚
â”‚ â˜ Wed  Review weekly report                         â”‚
â”‚ â˜ Fri  Backup verification (4+ exist)               â”‚
â”‚ â˜ Sun  VACUUM & log rotation                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

STATUS: âœ… Ready to Deploy

You are ready to:
1. Install: INSTALL.bat
2. Configure: SETUP_WIZARD.bat
3. Trade: RUN_PRODUCTION.bat

Good luck! ğŸ“ˆ

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
